# PRD (Product Requirements Document) - budongsan-v2

- Version: v1.0
- Date: 2026-02-28
- Product: budongsan-v2
- Scope: MVP -> V1 -> V2

## 1. 배경
기존 프로젝트는 기능은 있었지만 데이터 신뢰성, 지도/검색 성능, 운영 워크플로우(인증/신고/검수)가 분리되지 않아 확장성이 낮았다. v2는 API-First와 데이터 중심 설계로 재구축한다.

## 2. 목표
1. 한국 부동산 탐색의 핵심인 "실거래 + 지도 + 검색"을 신뢰성 있게 제공
2. 단지 중심 데이터 제품으로 확장 가능한 기반 확보
3. 향후 중개사 인증/KYC 및 신고/제재 워크플로우를 위한 권한/감사 구조 선설계

## 3. 비목표 (MVP)
1. 중개사 가입/인증 실제 운영
2. 결제/광고 과금
3. 고급 AI 대화형 추천
4. 3D/VR 투어

## 4. 핵심 사용자
1. 일반 사용자(매수/전세/월세 탐색)
2. 데이터 중심 사용자(단지 비교)
3. 운영자(데이터 품질 점검)

## 5. 사용자 문제
1. 신뢰 가능한 실거래 데이터를 빠르게 확인하기 어렵다.
2. 지도에서 원하는 범위 매물을 필터링하기 어렵다.
3. 단지별 가격 흐름을 한눈에 보기 어렵다.

## 6. 성공 지표 (KPI)

### MVP KPI
1. `GET /api/deals` 성공률 99%+
2. `GET /api/map/complexes` p95 500ms 이하(캐시 hit 기준)
3. API 오류율 1% 미만
4. 일간 재방문율(DAU returning ratio) baseline 확보

### V1 KPI
1. 단지 상세 페이지 평균 체류시간 +20%
2. 관심단지 저장 전환율 5%+
3. 알림 opt-in 8%+

### V2 KPI
1. 중개사 인증 승인 리드타임(중앙값) 24h 이하
2. 허위매물 신고 처리 SLA 48h 이하
3. 리드 응답률 60%+

## 7. 기능 범위

## 7.1 MVP
1. 실거래 조회 API
2. 지도 bbox 단지 조회 API
3. 기본 지도 화면 + 마커 렌더
4. 환경변수/품질 게이트(lint/build)
5. 수집/정규화 파이프라인 설계 초안

## 7.2 V1
1. 단지 상세 지표(거래량/평형/추세)
2. 검색 API(`/api/search`)
3. 관심단지/알림
4. 운영 검수 화면(내부용)

## 7.3 V2
1. 중개사 인증/KYC
2. 허위매물 신고/제재 상태머신
3. 리드 전달 및 노출 상품
4. 감사로그 기반 운영 대시보드

## 8. 요구사항 상세

### R1. 데이터 정확성
- 공공 API 응답 파싱 오류율 0.5% 이하
- 필수 필드 누락 시 에러 코드 표준화

### R2. 지도 응답
- bbox 파라미터 없으면 전체 default 범위로 제한 응답
- 최대 반환 건수 제한(예: 300)

### R3. API 계약
- 모든 입력은 zod 검증
- 응답 표준: `{ ok, ... }`

### R4. 품질 게이트
- `npm run lint` 통과 필수
- `npm run build` 통과 필수

### R5. 보안
- API 키는 서버 환경변수로만 보관
- 로그에 민감 키 노출 금지

## 9. 비기능 요구사항
1. 성능: 지도 API p95 500ms, 검색 API p95 700ms 목표
2. 안정성: API 오류율 1% 미만
3. 확장성: PostGIS 전환 시 API 계약 유지
4. 관측성: 요청 ID, 에러 코드, latency 로그

## 10. 릴리즈 계획

### Sprint 1 (1주)
1. PostGIS 도입 설계
2. 실거래/지도 API 스모크 자동화
3. 에러 코드 표준

### Sprint 2 (2주)
1. `/api/search` MVP
2. 단지 상세 API 초안
3. 운영 로그 대시보드 초안

### Sprint 3 (3~4주)
1. 단지 지표 계산 파이프라인
2. 관심단지/알림 MVP
3. 성능 튜닝

## 11. 리스크 및 대응
1. 외부 API 호출 제한/지연
   - 대응: 캐시, 재시도, 배치 수집
2. 좌표 데이터 부정확
   - 대응: 표준 지오코딩 테이블, 검증 큐
3. 범위 확장으로 인한 일정 지연
   - 대응: P0/P1/P2 스코프 게이트

## 12. 승인 기준
1. MVP KPI 계측 가능 상태
2. 문서/코드 일치
3. 운영 체크리스트(runbook) 준비
